---
title: "Summer in Italy: A Seasonal Analysis of Airbnb Trends"
author: Luke Checchio
date: Fall 2024
output: 
  pdf_document:
    fig_caption: yes
execute:
  echo: false
  warning: false
  message: false
---

```{r}
#| label: load-packages

suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(tidymodels))
suppressPackageStartupMessages(library(sf))
suppressPackageStartupMessages(library(lme4))
suppressPackageStartupMessages(library(MuMIn))
suppressPackageStartupMessages(library(patchwork))
suppressPackageStartupMessages(library(knitr))

opts_chunk$set(echo = F, warning = F, message = F, fig.width = 4, fig.height = 3, fig.show = "asis")
```

```{r}
#| label: load-data

city_grouped <- read.csv("data/airbnb_italian_city_grouped.csv") |>
  mutate(across(where(is.character), str_to_lower))
neighbourhood_grouped <- read.csv("data/airbnb_italian_neighbourhood_grouped.csv") |>
  mutate(across(where(is.character), str_to_lower))
city_data <- read.csv("data/airbnb_italy_city.csv") |>
  mutate(across(where(is.character), str_to_lower))
neighbourhoods_geo <- st_read("data/airbnb_italy_city_neighbourhoods_geojson.geojson", quiet = T) |>
  mutate(across(where(is.character), str_to_lower))
city_neighbourhoods <- read.csv("data/airbnb_italy_city_neighbourhoods.csv") |>
  mutate(across(where(is.character), str_to_lower))
```

# 1. Introduction

## 1.1 Motivation

After dropping to historic lows in the midst of the COVID-19 pandemic, travel is well on track to recover to pre-2020 levels. These trends show no sign of a slowing, and by 2030, international travel is expected to reach 9 billion lodging nights per year (McKinsey & Company).Since the advent of Airbnb, the landscape of short-term lodging and tourism has transformed dramatically, providing an unprecedented array of choices for travelers and a novel source of income for property owners. Italy, with its rich cultural heritage and popular tourist destinations, has seen significant growth in Airbnb listings, particularly in major cities and tourist hubs. In fact, today, Airbnb accounts for the second largest share of online bookings within the country, at a nearly 30% market share (Statista). The dynamics of pricing within the Italian Airbnb market, however, remain complex and subject to various influences, including seasonal fluctuations which significantly impact both availability and cost.

The interplay between seasonality and pricing is critical in tourism-centric economies like Italy's, where different regions experience peak tourist seasons at various times of the year. For example, coastal areas see a surge during summer months, while cities rich in art and history, such as Florence and Rome, typically can attract visitors year-round. Understanding these patterns is essential not only for economic forecasting and business planning for hosts but also for policy-making in tourism management.

This research project aims to delve into the seasonal trends in Airbnb pricing across Italy, exploring connections across 5 major Italian tourist hubs. By analyzing a comprehensive dataset of Airbnb listings that includes detailed pricing information, review scores, host details, and more from December 2023 to September 2024, this study seeks to uncover insights that could inform more strategic pricing and marketing decisions for Airbnb hosts and provide policymakers with data to better understand the economics of short-term rentals. The findings aim to contribute to the broader discourse on sustainable tourism in Italy, balancing economic benefits with community impacts and long-term viability.

## 1.2 Dataset and Variables

```{r}
#| label: data-modification-split

city_data <- city_data |>
  group_by(id) |>
  mutate(relative_price = price / mean(price), prop_reviews = number_of_reviews / sum(number_of_reviews), n = n())

city_data <- city_data |>
  group_by(place) |>
  mutate(relative_lat = abs(latitude - mean(latitude)), relative_long = abs(longitude - mean(longitude)))

city_data$log_price <- log(city_data$price)

city_data <- city_data |>
  mutate(period = case_when(period == "early spring" ~ "Spring",
                            period == "early autumn" ~ "Fall",
                            period == "early summer" ~ "Summer",
                            period == "early winter" ~ "Winter"))

city_data$period <- factor(city_data$period, levels = c("Spring", "Summer", "Fall", "Winter"))

firenze_data <- city_data |> filter(place == "firenze")
milano_data <- city_data |> filter(place == "milano")
napoli_data <- city_data |> filter(place == "napoli")
roma_data <- city_data |> filter(place == "roma")
venezia_data <- city_data |> filter(place == "venezia")
```

The dataset used for this study comprises Airbnb listing records from five major Italian cities: Florence, Milan, Naples, Rome, and Venice. Data were methodically scraped on a quarterly basis from December 2023 to September 2024 to capture seasonal variations in listing attributes, correlating each data collection round with one of the four seasons. This temporal alignment lends itself to a detailed examination of how seasonal factors influence Airbnb pricing, amongst other variables.

Data collection was conducted using a consistent unique identifier for each listing across all scraping sessions, facilitating longitudinal analysis of the same properties over time. Each record includes the listing price at the time of scraping, whether the host is designated as a "superhost" (a status awarded by Airbnb to hosts recognized for exceptional service), the neighborhood and precise coordinates of the listing, room type, maximum guest capacity, aggregate review scores, the city of the listing, and the season during which the data were collected. In total, the dataset encompasses 245,035 individual entries across 89,306 unique Airbnb listings.

Significant steps were undertaken to prepare and refine the dataset for analysis The price variable exhibited a right-skewed distribution with several extreme outliers; to address this, a logarithmic transformation was applied to normalize the data using the natural logarithm, significantly improving its suitability for regression analysis (details are elaborated in the Exploratory Analysis section and the Appendix). Additionally, the initial exploration revealed challenges in incorporating location data due to the high variability and large number of neighborhoods—up to 114 in Venice alone. To streamline the analysis and avoid the pitfalls of overfitting, standardized location metrics termed relative latitude and relative longitude were developed. These metrics measure each listing’s deviation from the average latitude and longitude of all listings within the same city, respectively, providing a standardized approach to quantify location effects within cities.

Additional datasets containing the same underlying data but grouped by city and neighbourhood as well as neighbourhood and city geospatial data for visualization purposes were used in exploratory analysis, but not ultimately included in the model fit.

## 1.3 Exploratory Analysis

Initial exploratory data analysis was conducted on a number of variables from the dataset to uncover potential trends in the data as well as to help guide variable selection for the eventual model.

```{r}
#| label: response-distribution
#| fig.cap: "Airbnb Log-Price Distribution"

ggplot(city_data, aes(x = log_price)) +
  geom_density(color = "#008C45", fill = "#83F0B9", size = 1.1) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold") 
  ) +
  labs(
    title = "Distribution of Log-transformed Airbnb prices in Italy",
    x = "Log-price",
    y = "Density"
  )
```

The plot above shows the log-transformed distribution of Airbnb prices in Italy. The transformation normalizes the price data, making it easier to observe common price points and variability. A similar plot of the prices prior to log-transformation is included in the Appendix, where it is clear that the distribution exhibits a heavy right-skew.

```{r}
#| label: seasonal-price-rome
#| fig.cap: "Median Airbnb Price Distribution by Neighbourhood, Season (Rome)"

neighbourhoods_geo <- neighbourhoods_geo |>
  left_join(city_neighbourhoods, by = "neighbourhood") |>
  transmute(neighbourhood = neighbourhood, city = city.y, 
            neighbourhood_group = neighbourhood_group.x, geometry = geometry)

grouped_neighbourhoods_full <- neighbourhoods_geo |>
  right_join(neighbourhood_grouped, by = c("neighbourhood" = "neighbourhood", "city" = "place")) |>
  group_by(neighbourhood, city, period) |>
  mutate(period_price = mean(price_median)) |>
  ungroup()

grouped_neighbourhoods_full <- grouped_neighbourhoods_full |>
  mutate(period = case_when(period == "early spring" ~ "Spring",
                            period == "early autumn" ~ "Fall",
                            period == "early summer" ~ "Summer",
                            period == "early winter" ~ "Winter"))

grouped_neighbourhoods_full$period <- factor(grouped_neighbourhoods_full$period, 
                                             levels = c("Spring", "Summer", "Fall", "Winter"))

ggplot(grouped_neighbourhoods_full |> filter(city == "roma")) + 
  geom_sf(aes(fill = price_median)) +
  facet_grid(~ period) +
  scale_fill_gradient(low = "#f2d8d9", high = "#CD212A") +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold"),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank()
  ) +
  labs(
    title = "Neighbourhood median Airbnb price by season, Rome",
    fill = "Median price (Euro)"
  )
```

The above plot displays a series of adjacent maps illustrating the median Airbnb prices by neighborhood across different seasons in Rome. The maps use a color gradient from light pink to dark red to depict the range of median prices in euros, with darker shades indicating higher prices. From the visualization, it seems that across most neighbourhoods, the median price tends to be higher in spring, summer, and fall than winter. This relationship is especially prevalent within the center-most neighbourhood, the Historic Center (Centro Historico), which turns noticeably darker in the summer and fall, indicating higher median Airbnb prices. Graphs similar to that which is displayed above are included in the appendix for the four other cities examined. The relationship between season and price was less obvious in the plots for Napoli and Milan, while Florence and Venice's graphs both exhibited characteristics similar to that observed in Rome's.

```{r}
#| label: guests-price
#| fig-cap: "Airbnb Log-Price Distribution by Maximum Guests Allowed"

city_data$accommodates <- factor(city_data$accommodates, levels = c(1:16))

ggplot(city_data, aes(x = accommodates, y = log_price)) +
  geom_boxplot(color = "#008C45", size = 1) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    #panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold"),
  ) +
  labs(
    title = "Distribution of Log-transformed Airbnb prices in Italy, by # of Guests Permitted",
    x = "Max. # of Guests",
    y = "Log-price"
  )
```


```{r}
#| label: rating-price
#| fig-cap: "Relationship Between Airbnb Log-Price and Guest Rating"

ggplot(city_data, aes(x = review_scores_rating, y = log_price)) +
  geom_point(color = "#CD212A", alpha = 0.1) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    #panel.grid.major = element_blank(),
    #panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold"),
  ) +
  labs(
    title = "Log-transformed Italian Airbnb prices vs. guest rating",
    x = "Guest Rating",
    y = "Log-price"
  )
```

```{r}
#| label: roomtype-price
#| fig-cap: "Airbnb Log-Price Distribution by Room Type"

city_data <- city_data |>
  mutate(room_type = case_when(room_type == "entire home/apt" ~ "Entire Home/Apartment",
                               room_type == "private room" ~ "Private Room",
                               room_type == "hotel room" ~ "Hotel Room",
                               room_type == "shared room" ~ "Shared Room"))

ggplot(city_data, aes(x = log_price)) +
  geom_density(color = "#008C45", fill = "#83F0B9", size = 1.1) +
  facet_grid(rows = vars(room_type)) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold"),
    strip.text.y = element_text(angle = 0, vjust = 0.5)
  ) +
  labs(
    title = "Distribution of Log-transformed Airbnb prices in Italy, by room type",
    x = "Log-price",
    y = "Density"
  )
```

```{r}
#| label: superhost-price
#| fig-cap: "Airbnb Log-Price Distribution by Superhost Status"

city_data <- city_data |>
  mutate(host_is_superhost = case_when(host_is_superhost == "t" ~ "Yes",
                                       host_is_superhost == "f" ~ "No"))

ggplot(city_data, aes(x = host_is_superhost, y = log_price)) +
  geom_boxplot(color = "#CD212A", size = 1) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    #panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold"),
  ) +
  labs(
    title = "Distribution of Log-transformed Airbnb prices in Italy, by superhost status",
    x = "Superhost?",
    y = "Log-price"
  )
```

```{r}
#| label: longitude-price
#| fig-cap: "Relationship Between Airbnb Log-Price and Relative Latitude/Longitude"

long_plot <- ggplot(city_data, aes(x = relative_lat, y = log_price)) +
  geom_point(color = "#008C45", alpha = 0.1) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    #panel.grid.major = element_blank(),
    #panel.grid.minor = element_blank(),
    panel.border = element_blank(),
  ) +
  labs(
    #title = "Log-transformed Italian Airbnb prices vs. relative longitude and latitude",
    x = "Relative longitude",
    y = "Log-price"
  )

lat_plot <- ggplot(city_data, aes(x = relative_long, y = log_price)) +
  geom_point(color = "#CD212A", alpha = 0.1) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    #panel.grid.major = element_blank(),
    #panel.grid.minor = element_blank(),
    panel.border = element_blank(),
  ) +
  labs(
    #title = "Log-transformed Italian Airbnb prices vs. relative latitude",
    x = "Relative latitude",
    y = ""
  )

(long_plot + lat_plot) + plot_annotation(title = "Log-transformed Italian Airbnb prices vs. relative latitude and longitude",
                                         theme = theme(plot.title = element_text(face = "bold")))
```

# 2. Methodology

## 2.1 Model and Variable Selection

```{r}
#| label: model-fitting

firenze_lmer <- lmer(log_price ~ (1 | id) + accommodates + review_scores_rating + room_type + host_is_superhost + 
                       relative_lat + relative_long + period, data = firenze_data)
milano_lmer <- lmer(log_price ~ (1 | id) + accommodates + review_scores_rating + room_type + host_is_superhost + 
                      relative_lat + relative_long + period, data = milano_data)
napoli_lmer <- lmer(log_price ~ (1 | id) + accommodates + review_scores_rating + room_type + host_is_superhost + 
                      relative_lat + relative_long + period, data = napoli_data)
roma_lmer <- lmer(log_price ~ (1 | id) + accommodates + review_scores_rating + room_type + host_is_superhost + 
                    relative_lat + relative_long + period, data = roma_data)
venezia_lmer <- lmer(log_price ~ (1 | id) + accommodates + review_scores_rating + room_type + host_is_superhost + 
                       relative_lat + relative_long + period, data = venezia_data)
```

This study aims to investigate the effect of seasonality on Italian Airbnb prices, providing insight into tourism trends in the country. The analysis began by considering a range of statistical models including linear regression, mixed models, quantile regression, quantile mixed models, Bayesian approaches, and robust linear mixed models. Initially, a comprehensive linear mixed model was explored, incorporating city as a fixed effect and an interaction term between city and season to capture local and temporal variations in Airbnb pricing. The model also used the listing ID as a random intercept to account for unobserved heterogeneity within listings. However, the model yielded relatively weak marginal and conditional $R^2$ values, suggesting that the model might not be effectively capturing the underlying patterns.

Consequently, the strategy was refined to fit separate linear mixed models for each of the five cities in the dataset—Florence, Milan, Naples, Rome, and Venice. Similar to the comprehensive model, each city-specific model used the listing ID as a random intercept, while the maximum guest capacity, aggregate review scores, room type, "superhost" status, relative coordinates of the listing, and the season at the time of data collection were used as the fixed effects. This approach simplified the models by reducing the number of predictors and focusing on city-specific trends, leading to more robust and interpretable results.

These variables used in the final model were selected through a combination of exploratory data analysis and domain knowledge. Variables were chosen based on their potential to explain variability in Airbnb pricing. The original plan included using the neighborhood as a predictor, but due to the inconsistent number of neighborhoods across cities and the resulting complexity, this was replaced with relative latitude and longitude measures. These measures standardized location data within each city, reducing model complexity while preserving important spatial information.

The intended response variable, price, exhibited extreme right-skewness, leading to extreme heteroscedasticity in the modeling process. A log transformation was applied to price, significantly mitigating heteroscedasticity and normalizing the distribution. This transformation was crucial for stabilizing variance and improving the interpretability of the model's output, though it did not completely eliminate heteroscedasticity. The remaining effects and their implications are discussed in Model Assumptions.

The selected model framework of a mixed linear model allows for detailed analysis of how seasonality influences Airbnb prices, adjusting for individual listing characteristics and broader geographic factors. This modeling approach enhances our understanding of pricing dynamics in the Airbnb market and provides valuable insights into factors that drive price variations.

## 2.2 Model Assumptions

For a linear mixed effect model to work, the assumptions are that the explanatory variables are related linearly to the response, the errors have constant variance, the errors are independent, the errors are Normally distributed, and there is little to no multicollinearity. For the purposes of this analysis, we are assuming that there indeed exists a linear relationship between the predictors chosen and the log of price of an Airbnb, which may or may not be true in reality. For all of the other conditions, certain visualizations and statistics were produced to inspect whether they hold true, each time being done separately for each model. All of the plots hereafter referred to are available in the appendix. To check the assumption of constant variance, a scatterplot of the fitted values versus the residual values was created. For each of the five cities, the plot of residuals against fitted values yielded horizontally spread clouds of data, with a slight fan-shape opening toward higher-fitted variables. This pattern was consistent across the cities, and is indicative of a potential violation of heteroskedasticity, a major flaw in the model. To check the assumption of independent error terms, the residual values were plotted by index to ensure no autocorrelation or seasonal patterns. These plots did not seem to cause concern for any of the 5 models. For the next condition of the errors having a Normal distribution, QQ-plots and density curves of the residuals were both output. While the density curves for the models appear normal to the naked eye, further inspection of the QQ-plots reveals the heavy-tailed nature of the distribution of residuals, and thus break from Normality. This is again a major flaw with the models fit, and was observed consistently across the five cities. Lastly, to check for the presence of multicollinearity, correlation matrices for the fixed effects were output for each model. One area of concern was high correlation between room type (in particular, private room or shared room) and maximum guests allowed. However, our correlation matrix analysis revealed that all predictors, including those of concern, had absolute correlation values of well below 0.7 - a commonly accepted threshold for a low risk of multicollinearity. 

Given the violations of homoskedasticity and normality of errors, as mentioned prior, numerous other approaches were attempted in order to reduce concerns associated with violations in model conditions. These approaches included, but were not limited to multiple linear regression, quantile regression, quantile mixed models, Bayesian approaches, and robust linear mixed models. All of these approaches were aimed at solving the issue of increasing variance of residuals at higher fitted values, leading to a heavy-tailed distribution of the residuals themselves. While these attempts were unsuccessful either due to the structure of the data (high number of random effects groups relative to the total number of observations) or limited domain knowledge to experiment fully with robust linear mixed models or Bayesian methods, there is certainly room for further improvement as will be discussed later in the report. Furthermore, all results from the model will be interpreted with caution due to the flaws in meeting the model criteria.

# 3. Results

The below tables showcase the results from the five city models. In particular, the tables contain the point estimates, standard errors, and test statistics for each of the fixed effects for the five models. Notice that the p-value is not provided, due to the fact that the degrees of freedom on the underlying distribution for each coefficient can be very hard to calculate. This is caused by the complex structure of mixed effects models, and as complexity increases the degrees of freedom become increasingly hard to categorize. However, given that our data uses solely a random intercept term, and the extremely high quantity of data, it is very likely that statistics with absolute values greater than 2 are indeed significant at the $\alpha = 0.05$ level, and can be casually interpreted as such (Baayen et al., 2008). 

With that in mind, our discussion of results will focus primarily on the season variables, in order to effectively answer our research question. However, it should be noted that there are indeed interesting and significant findings when it comes to the other predictors that were adjusted for in the model fitting.

```{r}
#| label: firenze-model-results

firenze_summary <- summary(firenze_lmer)
firenze_coef <- firenze_summary$coefficients
rownames(firenze_coef) <- c("Intercept", "Max. Guests", "Avg. Review Score", "Room Type | Hotel", "Room Type | Private", "Room Type | Shared",
                         "Superhost Status", "Relative Latitude", "Relative Longitude", "Season | Summer", "Season | Winter")
firenze_coef <- as.data.frame(firenze_coef) |> round(3) |> rownames_to_column("Variable")


firenze_coef |> kable(col.names = c("Variable", "Estimate", "Std. Error", "df", "Statistic", "p"))
```

The coefficient of 0.117 for summer in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Florence in the summer is expected to be 0.117 units higher than in the spring, or a $e^{0.117} - 1 \approx 12.4\%$ increase in the price in Euros relative to spring. Conversely, the coefficient of -0.125 for winter in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Florence in the winter is expected to be 0.125 units lower than in the spring, or a $e^{-0.125} - 1 \approx -11.8\%$ decrease in the price in Euros relative to spring.

```{r}
#| label: milano-model-results

milano_summary <- summary(milano_lmer)
milano_coef <- milano_summary$coefficients
rownames(milano_coef) <- c("Intercept", "Max. Guests", "Avg. Review Score", "Room Type | Hotel", "Room Type | Private", "Room Type | Shared",
                         "Superhost Status", "Relative Latitude", "Relative Longitude", "Season | Summer", "Season | Winter")
milano_coef <- as.data.frame(milano_coef) |> round(3) |> rownames_to_column("Variable")


milano_coef |> kable(col.names = c("Variable", "Estimate", "Std. Error", "df", "Statistic", "p"))
```

The coefficient of 0.037 for summer in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Milan in the summer is expected to be 0.037 units higher than in the spring, or a $e^{0.037} - 1 \approx 3.4\%$ increase in the price in Euros relative to spring. Conversely, the coefficient of -0.021 for winter in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Milan in the winter is expected to be 0.021 units lower than in the spring, or a $e^{-0.021} - 1 \approx -2.1\%$ decrease in the price in Euros relative to spring.

```{r}
#| label: napoli-model-results

napoli_summary <- summary(napoli_lmer)
napoli_coef <- napoli_summary$coefficients
rownames(napoli_coef) <- c("Intercept", "Max. Guests", "Avg. Review Score", "Room Type | Hotel", "Room Type | Private", "Room Type | Shared",
                         "Superhost Status", "Relative Latitude", "Relative Longitude", "Season | Summer", "Season | Winter")
napoli_coef <- as.data.frame(napoli_coef) |> round(3) |> rownames_to_column("Variable")


napoli_coef |> kable(col.names = c("Variable", "Estimate", "Std. Error", "df", "Statistic", "p"))
```

The coefficient of 0.025 for summer in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Naples in the summer is expected to be 0.025 units higher than in the spring, or a $e^{0.025} - 1 \approx 2.5\%$ increase in the price in Euros relative to spring. Conversely, the coefficient of -0.016 for winter in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Naples in the winter is expected to be 0.016 units lower than in the spring, or a $e^{-0.016} - 1 \approx -1.6\%$ decrease in the price in Euros relative to spring.

```{r}
#| label: roma-model-results

roma_summary <- summary(roma_lmer)
roma_coef <- roma_summary$coefficients
rownames(roma_coef) <- c("Intercept", "Max. Guests", "Avg. Review Score", "Room Type | Hotel", "Room Type | Private", "Room Type | Shared",
                         "Superhost Status", "Relative Latitude", "Relative Longitude", "Season | Summer", "Season | Fall", "Season | Winter")
roma_coef <- as.data.frame(roma_coef) |> round(3) |> rownames_to_column("Variable")


roma_coef |> kable(col.names = c("Variable", "Estimate", "Std. Error", "df", "Statistic", "p"))
```

The coefficient of 0.137 for summer in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Rome in the summer is expected to be 0.137 units higher than in the spring, or a $e^{0.137} - 1 \approx 14.7\%$ increase in the price in Euros relative to spring. In a similar fashion, the coefficient of 0.122 for fall in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Rome in the fall is expected to be 0.122 units higher than in the spring, or a $e^{0.122} - 1 \approx 13.0\%$ increase in the price in Euros relative to spring. Conversely, the coefficient of -0.141 for winter in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Rome in the winter is expected to be 0.141 units lower than in the spring, or a $e^{-0.141} - 1 \approx -13.2\%$ decrease in the price in Euros relative to spring.

```{r}
#| label: venezia-model-results

venezia_summary <- summary(venezia_lmer)
venezia_coef <- venezia_summary$coefficients
rownames(venezia_coef) <- c("Intercept", "Max. Guests", "Avg. Review Score", "Room Type | Hotel", "Room Type | Private", "Room Type | Shared",
                         "Superhost Status", "Relative Latitude", "Relative Longitude", "Season | Summer", "Season | Fall", "Season | Winter")
venezia_coef <- as.data.frame(venezia_coef) |> round(3) |> rownames_to_column("Variable")


venezia_coef |> kable(col.names = c("Variable", "Estimate", "Std. Error", "df", "Statistic", "p"))
```

The coefficient of 0.205 for summer in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Venice in the summer is expected to be 0.205 units higher than in the spring, or a $e^{0.205} - 1 \approx 22.8\%$ increase in the price in Euros relative to spring. In a similar fashion, the coefficient of 0.248 for fall in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Venice in the fall is expected to be 0.248 units higher than in the spring, or a $e^{0.248} - 1 \approx 28.1\%$ increase in the price in Euros relative to spring. Conversely, the coefficient of -0.063 for winter in our model indicates that, while controlling for the other variables in our model, including the unique listing itself, the log price of a night at an Airbnb in Rome in the winter is expected to be 0.063 units lower than in the spring, or a $e^{-0.063} - 1 \approx -6.1\%$ decrease in the price in Euros relative to spring.

# 4. Discussion

From our research, it is evident that seasonal variations significantly influence Airbnb pricing across the major Italian cities examined, with each reflecting distinct local demand dynamics and tourist flows. In Florence, summer brings a noticeable increase in Airbnb prices, with a 12.4% rise compared to spring, which could likely be explained by heightened demand driven by peak tourist activity. Winter, on the other hand, sees a reduction in prices by approximately 11.8%, which may indicate a strategic lowering of rates to attract visitors during the off-peak season. Milan, which is known for it's dual appeal as both a tourist destination and a business hub, exhibits relatively more moderate seasonal price fluctuations. Prices increase by just 3.4% in the summer and decrease by a slight 2.1% during winter, when adjusting for the other variables in our model. This pattern may reflect Milan's less pronounced seasonal tourist changes and its steady year-round visitor rate. Naples shows similar trends to Milan, with a 2.5% increase in summer prices and a modest 1.6% decrease in winter; Naples' temperate climate and year-round attractions may play a role in tempering the seasonal variability observed in the other Italian cities. In contrast, Rome experiences significant pricing dynamics with a robust 14.7% increase in summer and a 13.0% increase in fall when accounting for the other variables of interest, which could be a symptom of its popularity during these peak periods for tourism. However, winter in Rome sees a substantial 13.2% drop in prices. One possible explanation is that this is an aggressive strategy to maintain occupancy during the city's less popular tourist months. Venice, of the five cities reviewed, presents the most dramatic shifts in seasonal pricing. The summer season sees a 22.8% price increase, and fall prices soar even higher by 28.1%. These sharp could be due to Venice's global appeal and significant tourist influx during cultural events. Despite these peaks, winter prices decrease by 6.1%, which, while less severe than the increases, still marks a notable adjustment from spring levels.

Overall, these patterns illustrate a clear strategic adaptation of Airbnb pricing to seasonal tourism trends, with price increases during typically high-demand  and decreases during slower months. Understanding these pricing fluctuations could provide valuable insights for Airbnb hosts aiming to optimize their efficiency or for policymakers gauging the impact of tourism on local economies. Nevertheless, the current analysis, while insightful, encounters limitations primarily due to violations of heteroskedasticity and normality of errors assumptions. Such violations can compromise the reliability of standard error estimates, which in turn affects the test statistics for our coefficient estimates. Additionally, the complexity and localized nature of models for each city may inhibit the generalizability of findings. The analysis is also highly dependent on the accuracy and completeness of Airbnb data. Inaccuracies in listing data could skew results, and external factors like local events or broader economic conditions, which could significantly impact Airbnb pricing, were not incorporated.

To enhance the robustness of findings, employing robust regression techniques could mitigate the influence of outliers and assumption violations. Exploring further transformations of skewed predictors or applying weights to observations may also address heteroskedasticity. Integrating a Bayesian approach could offer flexibility in handling assumptions and incorporating prior knowledge. Developing a unified model that includes interactions between city and other predictors might reveal broader, more generalizable patterns.

Looking forward, future work could effectively explore interaction effects between seasonality and other variables such as room type or host status to uncover complex dynamics that influence pricing. Investigating how macro-economic factors like inflation rates or local economic conditions affect Airbnb pricing could yield insights into external influences on pricing trends not captured here. A longitudinal study spanning several years would be valuable in understanding long-term trends and responses to significant events or policy changes, and would increase the amount of data available for each listing, which is currently limited. Additionally, expanding the geographic scope of the analysis to include more diverse locations could help understand how different settings influence Airbnb pricing strategies. These directions not only aim to address current limitations but also enrich our understanding of the marketplace as a whole.

\newpage

# Appendix

## References

https://www.mckinsey.com/industries/travel-logistics-and-infrastructure/our-insights/now-boarding-faces-places-and-trends-shaping-tourism-in-2024

https://www.statista.com/forecasts/1000846/hotel-private-accommodation-online-bookings-by-brand-in-italy

https://www.kaggle.com/datasets/salvatoremarcello/italian-airbnb-dataset?select=airbnb.csv

https://yihui.org/knitr/options/#chunk-options

https://patchwork.data-imaginist.com/articles/guides/annotation.html

https://www.st-andrews.ac.uk/media/ceed/students/mathssupport/mixedeffectsknir.pdf

https://www.sciencedirect.com/science/article/pii/S0749596X07001398

*Put citations here*

## Additional Exploratory Data Analysis

```{r}
#| label: response-distribution-original
#| fig.cap: "Airbnb Price Distribution"

ggplot(city_data, aes(x = price)) +
  geom_density(color = "#008C45", fill = "#CD212A", size = 1.2) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold") 
  ) +
  xlim(10, 2500) +
  labs(
    title = "Distribution of Airbnb prices in Italy",
    x = "Price (Euros)",
    y = "Density",
    caption = "Note: Price observations greater than 2500 (n = 447) are excluded from this plot for clarity."
  )
```

```{r}
#| label: seasonal-price-florence
#| fig.cap: "Median Airbnb Price Distribution by Neighbourhood, Season (Florence)"

ggplot(grouped_neighbourhoods_full |> filter(city == "firenze")) + 
  geom_sf(aes(fill = price_median)) +
  facet_grid(~ period) +
  scale_fill_gradient(low = "#f2d8d9", high = "#CD212A") +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold") ,
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank()
  ) +
  labs(
    title = "Neighbourhood median Airbnb price by season, Florence",
    fill = "Median Price (Euro)"
  )

```

```{r}
#| label: seasonal-price-milan
#| fig.cap: "Median Airbnb Price Distribution by Neighbourhood, Season (Milan)"

ggplot(grouped_neighbourhoods_full |> filter(city == "milano")) + 
  geom_sf(aes(fill = price_median)) +
  facet_grid(~ period) +
  scale_fill_gradient(low = "#f2d8d9", high = "#CD212A") +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold") ,
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank()
  ) +
  labs(
    title = "Neighbourhood median Airbnb price by season, Milan",
    fill = "Median Price (Euro)"
  )

```

```{r}
#| label: seasonal-price-naples
#| fig.cap: "Median Airbnb Price Distribution by Neighbourhood, Season (Naples)"

ggplot(grouped_neighbourhoods_full |> filter(city == "napoli")) + 
  geom_sf(aes(fill = price_median)) +
  facet_grid(~ period) +
  scale_fill_gradient(low = "#f2d8d9", high = "#CD212A") +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold") ,
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank()
  ) +
  labs(
    title = "Neighbourhood median Airbnb price by season, Naples",
    fill = "Median Price (Euro)"
  )

```

```{r}
#| label: seasonal-price-venice
#| fig.cap: "Median Airbnb Price Distribution by Neighbourhood, Season (Venice)"

ggplot(grouped_neighbourhoods_full |> filter(city == "venezia")) + 
  geom_sf(aes(fill = price_median)) +
  facet_grid(~ period) +
  scale_fill_gradient(low = "#f2d8d9", high = "#CD212A") +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "#FFFFFF", color = NA),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold") ,
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank()
  ) +
  labs(
    title = "Neighbourhood median Airbnb price by season, Venice",
    fill = "Median Price (Euro)"
  )
```


## Model Investigation

### Firenze Model

```{r}
#| label: model-checking-firenze

# model summary output
summary(firenze_lmer)

# model anova
anova(firenze_lmer)

# model marginal and conditional r-squared
r.squaredGLMM(firenze_lmer)

# model residual vs. fitted plot
plot(fitted(firenze_lmer), resid(firenze_lmer))

# autocorrelation check plot
plot(resid(firenze_lmer))

# model qq plot
qqnorm(resid(firenze_lmer))
qqline(resid(firenze_lmer))

# model residual density plot
plot(density(resid(firenze_lmer)))
```

### Milano Model

```{r}
#| label: model-checking-milano

# model summary output
summary(milano_lmer)

# model anova
anova(milano_lmer)

# model marginal and conditional r-squared
r.squaredGLMM(milano_lmer)

# model residual vs. fitted plot
plot(fitted(milano_lmer), resid(milano_lmer))

# autocorrelation check plot
plot(resid(milano_lmer))

# model qq plot
qqnorm(resid(milano_lmer))
qqline(resid(milano_lmer))

# model residual density plot
plot(density(resid(milano_lmer)))
```

### Napoli Model

```{r}
#| label: model-checking-napoli

# model summary output
summary(napoli_lmer)

# model anova
anova(napoli_lmer)

# model marginal and conditional r-squared
r.squaredGLMM(napoli_lmer)

# model residual vs. fitted plot
plot(fitted(napoli_lmer), resid(napoli_lmer))

# autocorrelation check plot
plot(resid(napoli_lmer))

# model qq plot
qqnorm(resid(napoli_lmer))
qqline(resid(napoli_lmer))

# model residual density plot
plot(density(resid(napoli_lmer)))
```

### Roma Data

```{r}
#| label: model-checking-roma

# model summary output
summary(roma_lmer)

# model anova
anova(roma_lmer)

# model marginal and conditional r-squared
r.squaredGLMM(roma_lmer)

# model residual vs. fitted plot
plot(fitted(roma_lmer), resid(roma_lmer))

# autocorrelation check plot
plot(resid(roma_lmer))

# model qq plot
qqnorm(resid(roma_lmer))
qqline(resid(roma_lmer))

# model residual density plot
plot(density(resid(roma_lmer)))
```

### Venezia Model

```{r}
#| label: model-checking-venezia

# model summary output
summary(venezia_lmer)

# model anova
anova(venezia_lmer)

# model marginal and conditional r-squared
r.squaredGLMM(venezia_lmer)

# model residual vs. fitted plot
plot(fitted(venezia_lmer), resid(venezia_lmer))

# autocorrelation check plot
plot(resid(venezia_lmer))

# model qq plot
qqnorm(resid(venezia_lmer))
qqline(resid(venezia_lmer))

# model residual density plot
plot(density(resid(venezia_lmer)))
```

